import { AfterViewInit, Component, OnDestroy } from '@angular/core';

@Component({
  selector: 'app-my-component',
  templateUrl: './my-component.component.html'
})
export class MyComponent implements AfterViewInit, OnDestroy {
  private resizeObserver!: ResizeObserver;

  ngAfterViewInit() {
    const iframeEl = document.getElementById('myIframe') as HTMLIFrameElement;

    // Wait for iframe content to load
    iframeEl.onload = () => {
      const iframeDoc = iframeEl.contentDocument || iframeEl.contentWindow?.document;

      if (iframeDoc) {
        const body = iframeDoc.body;

        // Initial body style override
        this.overrideIframeBodyStyle(body);

        // Observe iframe resize and override style again if needed
        this.resizeObserver = new ResizeObserver(() => {
          console.log('Iframe resized. Reapplying body styles.');
          this.overrideIframeBodyStyle(body);
        });

        this.resizeObserver.observe(iframeEl);
      }
    };
  }

  overrideIframeBodyStyle(body: HTMLBodyElement) {
    body.style.padding = '0px';
    body.style.backgroundColor = '#f0f0f0';
    body.style.fontFamily = 'Arial, sans-serif';
  }

  ngOnDestroy() {
    if (this.resizeObserver) {
      this.resizeObserver.disconnect();
    }
  }
}
