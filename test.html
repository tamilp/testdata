import json
import math

def split_json_file(input_file, num_files, base_filename="output"):
    # Read input JSON
    with open(input_file, "r") as f:
        data = json.load(f)

    if not isinstance(data, list):
        raise ValueError("JSON root must be a list")

    total_items = len(data)
    chunk_size = math.ceil(total_items / num_files)

    # Split and write
    for i in range(num_files):
        start = i * chunk_size
        end = start + chunk_size
        chunk = data[start:end]

        if chunk:  # skip empty chunks
            filename = f"{base_filename}_{i+1}.json"
            with open(filename, "w") as f:
                json.dump(chunk, f, indent=2)

            print(f"Created {filename} with {len(chunk)} records")

# ===== RUN =====
split_json_file("input.json", 3)
